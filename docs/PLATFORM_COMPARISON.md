# GitLab / GitHub / Gitea å¹³å°å¤„ç†å·®å¼‚å¯¹æ¯”

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº†æœ¬ç³»ç»Ÿåœ¨å¤„ç† GitLabã€GitHub å’Œ Gitea ä¸‰ä¸ªä»£ç æ‰˜ç®¡å¹³å°æ—¶çš„å·®å¼‚å’ŒåŸå› ã€‚

## ğŸ“‹ ç›®å½•

- [å¿«é€Ÿå¯¹æ¯”è¡¨](#å¿«é€Ÿå¯¹æ¯”è¡¨)
- [è¯¦ç»†å·®å¼‚è¯´æ˜](#è¯¦ç»†å·®å¼‚è¯´æ˜)
- [ä¸ºä»€ä¹ˆä¼šæœ‰è¿™äº›å·®å¼‚](#ä¸ºä»€ä¹ˆä¼šæœ‰è¿™äº›å·®å¼‚)
- [ä½¿ç”¨å»ºè®®](#ä½¿ç”¨å»ºè®®)

---

## å¿«é€Ÿå¯¹æ¯”è¡¨

| ç‰¹æ€§ | GitLab | GitHub | Gitea |
|------|--------|--------|-------|
| **Webhook è¯†åˆ«æ–¹å¼** | `object_kind` å­—æ®µ | `X-GitHub-Event` Header | `X-Gitea-Event` Header |
| **äº‹ä»¶ç±»å‹å­—æ®µ** | `merge_request` / `push` | `pull_request` / `push` | `pull_request` / `push` |
| **API åŸºç¡€è·¯å¾„** | `/api/v4/` | `/api/v3/` | `/api/v1/` |
| **è®¤è¯æ–¹å¼** | `Private-Token` Header | `Authorization: token` Header | `Authorization: token` Header |
| **è·å–å˜æ›´ API** | `/merge_requests/{iid}/changes` | `/pulls/{number}/files` | `/pulls/{number}/files` |
| **æ·»åŠ è¯„è®º API** | `/merge_requests/{iid}/notes` | `/issues/{number}/comments` | `/issues/{number}/comments` æˆ– `/pulls/{number}/comments` |
| **Commit è¯„è®ºæ”¯æŒ** | âœ… æ”¯æŒ | âœ… æ”¯æŒ | âš ï¸ 1.13.0+ æ”¯æŒ |
| **Issue æ¨¡å¼** | âŒ ä¸æ”¯æŒ | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒï¼ˆæ¨èï¼‰ |
| **æ•°æ®æ ¼å¼** | è‡ªå®šä¹‰æ ¼å¼ | GitHub æ ‡å‡†æ ¼å¼ | GitHub å…¼å®¹æ ¼å¼ |
| **Diff è·å–æ–¹å¼** | ç›´æ¥è¿”å›å®Œæ•´ diff | ç›´æ¥è¿”å›å®Œæ•´ diff | å¯èƒ½éœ€è¦å¤šæ¬¡ API è°ƒç”¨ |

---

## è¯¦ç»†å·®å¼‚è¯´æ˜

### 1. Webhook è¯†åˆ«æ–¹å¼

#### GitLab
```python
# é€šè¿‡ payload ä¸­çš„ object_kind å­—æ®µè¯†åˆ«
object_kind = data.get("object_kind")  # "merge_request" æˆ– "push"
```

**åŸå› **ï¼šGitLab çš„ Webhook è®¾è®¡å°†äº‹ä»¶ç±»å‹ç›´æ¥æ”¾åœ¨ JSON payload ä¸­ï¼Œè¿™æ˜¯ GitLab çš„ä¼ ç»Ÿè®¾è®¡æ–¹å¼ã€‚

#### GitHub
```python
# é€šè¿‡ HTTP Header è¯†åˆ«
github_event = request.headers.get('X-GitHub-Event')  # "pull_request" æˆ– "push"
```

**åŸå› **ï¼šGitHub é‡‡ç”¨ HTTP Header ä¼ é€’äº‹ä»¶ç±»å‹ï¼Œè¿™æ˜¯ GitHub Webhook çš„æ ‡å‡†è®¾è®¡ï¼Œä¾¿äºåœ¨æ¥æ”¶è¯·æ±‚æ—¶å¿«é€Ÿåˆ¤æ–­äº‹ä»¶ç±»å‹ï¼Œæ— éœ€è§£æ JSONã€‚

#### Gitea
```python
# é€šè¿‡ HTTP Header è¯†åˆ«ï¼ˆå…¼å®¹ GitHub æ ¼å¼ï¼‰
gitea_event = request.headers.get('X-Gitea-Event')  # "pull_request" æˆ– "push"
```

**åŸå› **ï¼šGitea ä¸ºäº†å…¼å®¹ GitHub çš„ç”Ÿæ€ï¼Œé‡‡ç”¨äº†ç±»ä¼¼çš„ Header è®¾è®¡ã€‚æ³¨æ„ï¼šGitea ä¼šåŒæ—¶å‘é€ `X-GitHub-Event` å’Œ `X-Gitea-Event`ï¼Œæ‰€ä»¥éœ€è¦ä¼˜å…ˆæ£€æŸ¥ `X-Gitea-Event`ã€‚

---

### 2. äº‹ä»¶å‘½åå·®å¼‚

| å¹³å° | Merge Request | Push Event |
|------|---------------|------------|
| **GitLab** | `merge_request` | `push` |
| **GitHub** | `pull_request` | `push` |
| **Gitea** | `pull_request` | `push` |

**åŸå› **ï¼š
- **GitLab** ä½¿ç”¨ "Merge Request" è¿™ä¸ªæœ¯è¯­ï¼Œæ‰€ä»¥äº‹ä»¶åä¸º `merge_request`
- **GitHub** å’Œ **Gitea** ä½¿ç”¨ "Pull Request" è¿™ä¸ªæœ¯è¯­ï¼Œæ‰€ä»¥äº‹ä»¶åä¸º `pull_request`
- è™½ç„¶æœ¯è¯­ä¸åŒï¼Œä½†åŠŸèƒ½ç›¸åŒï¼šéƒ½æ˜¯å°†ä»£ç ä»ä¸€ä¸ªåˆ†æ”¯åˆå¹¶åˆ°å¦ä¸€ä¸ªåˆ†æ”¯çš„è¯·æ±‚

---

### 3. API ç«¯ç‚¹å·®å¼‚

#### è·å–ä»£ç å˜æ›´

**GitLab**
```
GET /api/v4/projects/{project_id}/merge_requests/{iid}/changes
```

**GitHub**
```
GET /api/v3/repos/{owner}/{repo}/pulls/{number}/files
```

**Gitea**
```
GET /api/v1/repos/{owner}/{repo}/pulls/{number}/files
```

**å·®å¼‚ç‚¹**ï¼š
- GitLab ä½¿ç”¨é¡¹ç›® ID å’Œå†…éƒ¨ IDï¼ˆiidï¼‰
- GitHub/Gitea ä½¿ç”¨ä»“åº“è·¯å¾„ï¼ˆowner/repoï¼‰å’Œ PR ç¼–å·
- API ç‰ˆæœ¬å·ä¸åŒï¼ˆv4 vs v3 vs v1ï¼‰

**åŸå› **ï¼š
- æ¯ä¸ªå¹³å°éƒ½æœ‰è‡ªå·±çš„ API è®¾è®¡ç†å¿µå’Œç‰ˆæœ¬ç®¡ç†ç­–ç•¥
- GitLab ä½¿ç”¨æ•°å­— ID æ›´åˆ©äºå†…éƒ¨ç³»ç»Ÿç®¡ç†
- GitHub/Gitea ä½¿ç”¨è·¯å¾„æ›´ç¬¦åˆ RESTful è®¾è®¡ï¼Œæ›´ç›´è§‚

---

#### æ·»åŠ è¯„è®º

**GitLab**
```
POST /api/v4/projects/{project_id}/merge_requests/{iid}/notes
```

**GitHub**
```
POST /api/v3/repos/{owner}/{repo}/issues/{number}/comments
```

**Gitea**
```
POST /api/v1/repos/{owner}/{repo}/issues/{number}/comments
æˆ–
POST /api/v1/repos/{owner}/{repo}/pulls/{number}/comments
```

**å·®å¼‚ç‚¹**ï¼š
- GitLab æœ‰ä¸“é—¨çš„ `notes` ç«¯ç‚¹
- GitHub å°† PR è§†ä¸º Issue çš„ä¸€ç§ï¼Œæ‰€ä»¥ä½¿ç”¨ `issues` ç«¯ç‚¹
- Gitea æ”¯æŒä¸¤ç§æ–¹å¼ï¼Œä½†ä¸åŒç‰ˆæœ¬å¯èƒ½æ”¯æŒä¸åŒçš„ç«¯ç‚¹

**åŸå› **ï¼š
- GitLab å°† MR è¯„è®ºå’Œ Issue è¯„è®ºåˆ†å¼€ç®¡ç†
- GitHub ç»Ÿä¸€ä½¿ç”¨ Issue ç³»ç»Ÿï¼ŒPR æ˜¯ Issue çš„å­ç±»å‹
- Gitea ä¸ºäº†å…¼å®¹æ€§ï¼ŒåŒæ—¶æ”¯æŒä¸¤ç§æ–¹å¼

---

### 4. æ•°æ®æ ¼å¼å·®å¼‚

#### ä»“åº“æ ‡è¯†

**GitLab**
```json
{
  "project": {
    "id": 12345
  }
}
```

**GitHub / Gitea**
```json
{
  "repository": {
    "full_name": "owner/repo"
  }
}
```

**åŸå› **ï¼š
- GitLab ä½¿ç”¨æ•°å­— ID ä½œä¸ºä¸»è¦æ ‡è¯†
- GitHub/Gitea ä½¿ç”¨å­—ç¬¦ä¸²è·¯å¾„ä½œä¸ºä¸»è¦æ ‡è¯†
- æ•°å­— ID æ›´åˆ©äºæ•°æ®åº“æŸ¥è¯¢ï¼Œå­—ç¬¦ä¸²è·¯å¾„æ›´åˆ©äºäººç±»é˜…è¯»

---

#### Commit ä¿¡æ¯æ ¼å¼

**GitLab**
```json
{
  "commits": [
    {
      "id": "abc123",
      "message": "fix bug",
      "author": {
        "name": "John"
      }
    }
  ]
}
```

**GitHub**
```json
{
  "commits": [
    {
      "id": "abc123",
      "message": "fix bug",
      "author": {
        "name": "John"
      }
    }
  ]
}
```

**Gitea**
```json
{
  "commits": [
    {
      "id": "abc123",
      "message": "fix bug",
      "author": {
        "name": "John"
      }
      // æˆ–è€… author å¯èƒ½æ˜¯å­—ç¬¦ä¸²
    }
  ]
}
```

**å·®å¼‚ç‚¹**ï¼š
- GitLab å’Œ GitHub æ ¼å¼åŸºæœ¬ä¸€è‡´
- Gitea çš„ `author` å­—æ®µå¯èƒ½æ˜¯å¯¹è±¡æˆ–å­—ç¬¦ä¸²ï¼ˆä¸åŒç‰ˆæœ¬ä¸åŒï¼‰

**åŸå› **ï¼š
- Gitea æ˜¯å¼€æºé¡¹ç›®ï¼Œä¸åŒç‰ˆæœ¬ä¹‹é—´å¯èƒ½å­˜åœ¨æ ¼å¼å·®å¼‚
- ä¸ºäº†å…¼å®¹æ€§ï¼Œä»£ç ä¸­éœ€è¦å¤„ç†å¤šç§æ ¼å¼

---

### 5. Diff è·å–æ–¹å¼å·®å¼‚

#### GitLab
- **æ–¹å¼**ï¼šç›´æ¥é€šè¿‡ `/changes` API è·å–ï¼Œè¿”å›å®Œæ•´çš„ diff
- **ç‰¹ç‚¹**ï¼šç®€å•ç›´æ¥ï¼Œä¸€æ¬¡ API è°ƒç”¨å³å¯

#### GitHub
- **æ–¹å¼**ï¼šé€šè¿‡ `/files` API è·å–ï¼Œæ¯ä¸ªæ–‡ä»¶åŒ…å« `patch` å­—æ®µ
- **ç‰¹ç‚¹**ï¼šç®€å•ç›´æ¥ï¼Œä¸€æ¬¡ API è°ƒç”¨å³å¯

#### Gitea
- **æ–¹å¼**ï¼šå¯èƒ½éœ€è¦å¤šæ¬¡ API è°ƒç”¨
  1. ä¼˜å…ˆå°è¯• `/files` APIï¼ˆå¯èƒ½ä¸åŒ…å« patchï¼‰
  2. å¦‚æœå¤±è´¥ï¼Œå°è¯• `/compare` API
  3. å¦‚æœè¿˜æ˜¯å¤±è´¥ï¼Œå°è¯• `/git/commits/{sha}.diff`
  4. æœ€åå°è¯•è·å–æ–‡ä»¶å†…å®¹æ‰‹åŠ¨ç”Ÿæˆ diff

**åŸå› **ï¼š
- Gitea ä¸åŒç‰ˆæœ¬çš„ API è¡Œä¸ºä¸ä¸€è‡´
- æŸäº›ç‰ˆæœ¬å¯èƒ½ä¸ç›´æ¥è¿”å› patchï¼Œéœ€è¦é¢å¤–å¤„ç†
- ä¸ºäº†å…¼å®¹æ€§ï¼Œä»£ç å®ç°äº†å¤šç§ fallback æœºåˆ¶

---

### 6. Commit è¯„è®ºæ”¯æŒ

| å¹³å° | æ”¯æŒæƒ…å†µ | API ç«¯ç‚¹ |
|------|---------|----------|
| **GitLab** | âœ… å®Œå…¨æ”¯æŒ | `/api/v4/projects/{id}/repository/commits/{sha}/comments` |
| **GitHub** | âœ… å®Œå…¨æ”¯æŒ | `/api/v3/repos/{owner}/{repo}/commits/{sha}/comments` |
| **Gitea** | âš ï¸ éƒ¨åˆ†ç‰ˆæœ¬æ”¯æŒ | `/api/v1/repos/{owner}/{repo}/commits/{sha}/comments` æˆ– `/api/v1/repos/{owner}/{repo}/git/commits/{sha}/comments` |

#### Gitea Commit Comments ç‰ˆæœ¬æ”¯æŒæƒ…å†µ

**æ”¯æŒçš„ç‰ˆæœ¬**ï¼š
- âœ… **Gitea 1.13.0+**ï¼šé€šå¸¸æ”¯æŒ commit comments API
- âœ… **Gitea 1.14.0+**ï¼šç¨³å®šæ”¯æŒ
- âœ… **Gitea 1.15.0+**ï¼šå®Œå…¨æ”¯æŒ
- âœ… **Gitea 1.16.0+**ï¼šå®Œå…¨æ”¯æŒ
- âœ… **Gitea 1.17.0+**ï¼šå®Œå…¨æ”¯æŒ
- âœ… **Gitea 1.18.0+**ï¼šå®Œå…¨æ”¯æŒ
- âœ… **Gitea 1.19.0+**ï¼šå®Œå…¨æ”¯æŒ
- âœ… **Gitea 1.20.0+**ï¼šå®Œå…¨æ”¯æŒ
- âœ… **Gitea 1.21.0+**ï¼šå®Œå…¨æ”¯æŒ
- âœ… **Gitea 1.22.0+**ï¼šå®Œå…¨æ”¯æŒ
- âœ… **Gitea 1.23.0+**ï¼šå®Œå…¨æ”¯æŒ
- âœ… **Gitea 1.24.0+**ï¼šå®Œå…¨æ”¯æŒ
- âœ… **Gitea 1.25.0+**ï¼šå®Œå…¨æ”¯æŒ

**ä¸æ”¯æŒçš„ç‰ˆæœ¬**ï¼š
- âŒ **Gitea 1.12.0 åŠæ›´æ—©ç‰ˆæœ¬**ï¼šä¸æ”¯æŒ commit comments API

**ç‰ˆæœ¬åˆ¤æ–­æ–¹æ³•**ï¼š
1. è®¿é—® Gitea å®ä¾‹çš„ `/api/v1/version` ç«¯ç‚¹æŸ¥çœ‹ç‰ˆæœ¬å·
2. æˆ–è€…æŸ¥çœ‹ Gitea ç®¡ç†åå°çš„ç‰ˆæœ¬ä¿¡æ¯
3. ç³»ç»Ÿä¼šè‡ªåŠ¨å°è¯•å¤šä¸ª API ç«¯ç‚¹ï¼Œå¦‚æœéƒ½è¿”å› 404ï¼Œè¯´æ˜è¯¥ç‰ˆæœ¬ä¸æ”¯æŒ

**ç³»ç»Ÿå¤„ç†æœºåˆ¶**ï¼š
- ç³»ç»Ÿä¼šå°è¯•ä»¥ä¸‹ä¸¤ä¸ª API ç«¯ç‚¹ï¼š
  1. `/api/v1/repos/{owner}/{repo}/commits/{sha}/comments`
  2. `/api/v1/repos/{owner}/{repo}/git/commits/{sha}/comments`
- å¦‚æœä¸¤ä¸ªç«¯ç‚¹éƒ½è¿”å› 404ï¼Œç³»ç»Ÿä¼šï¼š
  1. è®°å½•è­¦å‘Šæ—¥å¿—
  2. è‡ªåŠ¨å¯ç”¨ Issue æ¨¡å¼ï¼ˆå¦‚æœ `GITEA_USE_ISSUE_MODE=1`ï¼‰
  3. å°†å®¡æŸ¥ç»“æœä¿å­˜åˆ°æ•°æ®åº“
  4. é€šè¿‡ IM é€šçŸ¥å‘é€å®¡æŸ¥ç»“æœ

**å¿«é€Ÿå‚è€ƒè¡¨**ï¼š

| Gitea ç‰ˆæœ¬ | Commit Comments æ”¯æŒ | æ¨èæ“ä½œ |
|-----------|---------------------|---------|
| < 1.13.0 | âŒ ä¸æ”¯æŒ | ä½¿ç”¨ Issue æ¨¡å¼ |
| 1.13.0 - 1.14.0 | âš ï¸ éƒ¨åˆ†æ”¯æŒ | å»ºè®®ä½¿ç”¨ Issue æ¨¡å¼ |
| 1.15.0+ | âœ… å®Œå…¨æ”¯æŒ | å¯ä»¥ä½¿ç”¨ Commit Comments æˆ– Issue æ¨¡å¼ |
| 1.18.0+ | âœ… å®Œå…¨æ”¯æŒ | æ¨èä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ |

**åŸå› **ï¼š
- GitLab å’Œ GitHub æ˜¯æˆç†Ÿçš„å•†ä¸šäº§å“ï¼ŒAPI ç¨³å®šä¸”å‘åå…¼å®¹
- Gitea æ˜¯å¼€æºé¡¹ç›®ï¼Œcommit comments åŠŸèƒ½æ˜¯åœ¨è¾ƒæ–°ç‰ˆæœ¬ä¸­å¼•å…¥çš„
- ä¸åŒç‰ˆæœ¬çš„ Gitea å¯èƒ½ä½¿ç”¨ä¸åŒçš„ API ç«¯ç‚¹è·¯å¾„
- ä¸ºäº†å…¼å®¹æ€§ï¼Œç³»ç»Ÿæä¾›äº† Issue æ¨¡å¼ä½œä¸ºå¯é çš„æ›¿ä»£æ–¹æ¡ˆ

---

### 7. Issue æ¨¡å¼ï¼ˆGitea ç‹¬æœ‰ï¼‰

**ä¸ºä»€ä¹ˆ Gitea éœ€è¦ Issue æ¨¡å¼ï¼Ÿ**

1. **API å…¼å®¹æ€§é—®é¢˜**ï¼šæŸäº› Gitea ç‰ˆæœ¬ä¸æ”¯æŒ commit comments API
2. **ç¨³å®šæ€§è€ƒè™‘**ï¼šIssue API åœ¨æ‰€æœ‰ç‰ˆæœ¬ä¸­éƒ½ç¨³å®šå¯ç”¨
3. **åŠŸèƒ½ä¼˜åŠ¿**ï¼š
   - å¯å®¡è®¡ï¼šæ‰€æœ‰å®¡æŸ¥è®°å½•éƒ½åœ¨ Issue ä¸­
   - å¯è¿½è¸ªï¼šå¯ä»¥æŸ¥çœ‹å†å²å®¡æŸ¥è®°å½•
   - å¯ç»Ÿè®¡ï¼šå¯ä»¥ç»Ÿè®¡å®¡æŸ¥æ•°é‡å’Œè´¨é‡
   - å¯ç®¡ç†ï¼šæ”¯æŒæ ‡ç­¾ã€çŠ¶æ€ç®¡ç†ç­‰

**å¦‚ä½•ä½¿ç”¨ Issue æ¨¡å¼ï¼Ÿ**

åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®ï¼š
```bash
GITEA_USE_ISSUE_MODE=1  # å¯ç”¨ Issue æ¨¡å¼
GITEA_REVIEW_ISSUE_LABELS=ai-review,code-review  # å¯é€‰ï¼šè®¾ç½®æ ‡ç­¾
```

**Issue æ¨¡å¼çš„å·¥ä½œæµç¨‹**ï¼š
1. ç³»ç»Ÿæ¥æ”¶åˆ° Push æˆ– PR äº‹ä»¶
2. åˆ›å»ºæˆ–æŸ¥æ‰¾å¯¹åº”çš„ Issueï¼ˆæ ‡é¢˜æ ¼å¼ï¼š`[AI Review] repo@branch:commit`ï¼‰
3. åœ¨ Issue ä¸­æ·»åŠ å®¡æŸ¥ç»“æœè¯„è®º
4. å¦‚æœ Issue ä¸å­˜åœ¨ï¼Œè‡ªåŠ¨åˆ›å»º

---

## ä¸ºä»€ä¹ˆä¼šæœ‰è¿™äº›å·®å¼‚ï¼Ÿ

### 1. å†å²åŸå› 

- **GitLab**ï¼šæœ€æ—©è®¾è®¡ï¼Œæœ‰è‡ªå·±çš„è®¾è®¡ç†å¿µ
- **GitHub**ï¼šè¡Œä¸šæ ‡å‡†ï¼Œå¾ˆå¤šå¹³å°éƒ½å‚è€ƒå®ƒçš„è®¾è®¡
- **Gitea**ï¼šä¸ºäº†å…¼å®¹ GitHub ç”Ÿæ€ï¼Œé‡‡ç”¨äº†ç±»ä¼¼çš„è®¾è®¡ï¼Œä½†ä½œä¸ºå¼€æºé¡¹ç›®ï¼Œä¸åŒç‰ˆæœ¬ä¹‹é—´å¯èƒ½å­˜åœ¨å·®å¼‚

### 2. è®¾è®¡ç†å¿µä¸åŒ

- **GitLab**ï¼šæ›´æ³¨é‡ä¼ä¸šçº§åŠŸèƒ½ï¼Œä½¿ç”¨æ•°å­— ID ä¾¿äºç³»ç»Ÿç®¡ç†
- **GitHub**ï¼šæ›´æ³¨é‡å¼€å‘è€…ä½“éªŒï¼Œä½¿ç”¨è·¯å¾„æ›´ç›´è§‚
- **Gitea**ï¼šè½»é‡çº§ï¼Œè¿½æ±‚ç®€å•ï¼Œä½†ä¸ºäº†å…¼å®¹æ€§éœ€è¦æ”¯æŒå¤šç§æ ¼å¼

### 3. æŠ€æœ¯å®ç°å·®å¼‚

- **API ç‰ˆæœ¬ç®¡ç†**ï¼šæ¯ä¸ªå¹³å°éƒ½æœ‰è‡ªå·±çš„ç‰ˆæœ¬ç­–ç•¥
- **æ•°æ®æ ¼å¼**ï¼šè™½ç„¶éƒ½ä½¿ç”¨ JSONï¼Œä½†å­—æ®µåå’Œç»“æ„ä¸åŒ
- **åŠŸèƒ½æ”¯æŒ**ï¼šä¸åŒå¹³å°å¯¹æŸäº›åŠŸèƒ½çš„æ”¯æŒç¨‹åº¦ä¸åŒ

---

## ä½¿ç”¨å»ºè®®

### 1. é€‰æ‹©å¹³å°æ—¶çš„è€ƒè™‘

- **GitLab**ï¼šé€‚åˆä¼ä¸šå†…ç½‘éƒ¨ç½²ï¼ŒåŠŸèƒ½å…¨é¢
- **GitHub**ï¼šé€‚åˆå¼€æºé¡¹ç›®ï¼Œç”Ÿæ€ä¸°å¯Œ
- **Gitea**ï¼šé€‚åˆè½»é‡çº§éƒ¨ç½²ï¼Œèµ„æºå ç”¨å°‘

### 2. é…ç½®å»ºè®®

#### GitLab
```bash
GITLAB_ACCESS_TOKEN=your_token
GITLAB_URL=https://your-gitlab.com
```

#### GitHub
```bash
GITHUB_ACCESS_TOKEN=your_token
GITHUB_URL=https://api.github.com
```

#### Gitea
```bash
GITEA_ACCESS_TOKEN=your_token
GITEA_URL=https://your-gitea.com
GITEA_USE_ISSUE_MODE=1  # æ¨èå¯ç”¨
```

### 3. å¸¸è§é—®é¢˜å¤„ç†

#### é—®é¢˜ï¼šGitea æ— æ³•æ·»åŠ è¯„è®º
**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **æ£€æŸ¥ Gitea ç‰ˆæœ¬**ï¼š
   - è®¿é—® `https://your-gitea.com/api/v1/version` æŸ¥çœ‹ç‰ˆæœ¬å·
   - å¦‚æœç‰ˆæœ¬ä½äº 1.13.0ï¼Œcommit comments API ä¸æ”¯æŒ
   - æ¨èä½¿ç”¨ Gitea 1.15.0 æˆ–æ›´é«˜ç‰ˆæœ¬
2. **å¯ç”¨ Issue æ¨¡å¼**ï¼ˆæ¨èï¼‰ï¼š
   ```bash
   GITEA_USE_ISSUE_MODE=1  # å¯ç”¨ Issue æ¨¡å¼
   ```
   Issue æ¨¡å¼åœ¨æ‰€æœ‰ Gitea ç‰ˆæœ¬ä¸­éƒ½ç¨³å®šå¯ç”¨
3. **æ£€æŸ¥ Token æƒé™**ï¼š
   - ç¡®ä¿ Token æœ‰ `repo` æƒé™
   - ç¡®ä¿ Token æœ‰å†™å…¥æƒé™ï¼ˆwrite accessï¼‰
4. **æŸ¥çœ‹æ—¥å¿—**ï¼š
   - æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—ï¼ŒæŸ¥çœ‹å…·ä½“çš„é”™è¯¯ä¿¡æ¯
   - ç³»ç»Ÿä¼šè‡ªåŠ¨å°è¯•å¤šä¸ª API ç«¯ç‚¹ï¼Œå¦‚æœéƒ½å¤±è´¥ä¼šè®°å½•è¯¦ç»†é”™è¯¯

#### é—®é¢˜ï¼šGitHub Webhook æ— æ³•è¯†åˆ«
**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ `X-GitHub-Event` Header æ˜¯å¦æ­£ç¡®ä¼ é€’
2. ç¡®è®¤ Webhook é…ç½®ä¸­çš„ Content Type ä¸º `application/json`

#### é—®é¢˜ï¼šGitLab è·å–ä¸åˆ°å˜æ›´
**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ Token æƒé™
2. ç¡®è®¤é¡¹ç›® ID æ˜¯å¦æ­£ç¡®
3. ç³»ç»Ÿä¼šè‡ªåŠ¨é‡è¯• 3 æ¬¡ï¼Œç­‰å¾… 10 ç§’åé‡è¯•

---

## æ€»ç»“

è™½ç„¶ä¸‰ä¸ªå¹³å°åœ¨ API è®¾è®¡ã€æ•°æ®æ ¼å¼ç­‰æ–¹é¢å­˜åœ¨å·®å¼‚ï¼Œä½†æœ¬ç³»ç»Ÿé€šè¿‡ç»Ÿä¸€çš„æŠ½è±¡å±‚å’Œé€‚é…å™¨æ¨¡å¼ï¼Œå®ç°äº†å¯¹ä¸‰ä¸ªå¹³å°çš„æ— ç¼æ”¯æŒã€‚ç”¨æˆ·åªéœ€è¦é…ç½®ç›¸åº”çš„ Token å’Œ URLï¼Œç³»ç»Ÿå°±èƒ½è‡ªåŠ¨è¯†åˆ«å¹³å°ç±»å‹å¹¶è°ƒç”¨å¯¹åº”çš„å¤„ç†é€»è¾‘ã€‚

**æ ¸å¿ƒè®¾è®¡ç†å¿µ**ï¼š
- **ç»Ÿä¸€æ¥å£**ï¼šå¯¹å¤–æä¾›ç»Ÿä¸€çš„ Webhook ç«¯ç‚¹
- **è‡ªåŠ¨è¯†åˆ«**ï¼šæ ¹æ® Header æˆ– Payload è‡ªåŠ¨è¯†åˆ«å¹³å°
- **é€‚é…å™¨æ¨¡å¼**ï¼šæ¯ä¸ªå¹³å°æœ‰ç‹¬ç«‹çš„å¤„ç†ç±»ï¼Œä½†æ¥å£ç»Ÿä¸€
- **å®¹é”™æœºåˆ¶**ï¼šé’ˆå¯¹ä¸åŒå¹³å°çš„ç‰¹æ€§ï¼Œå®ç°å¤šç§ fallback æ–¹æ¡ˆ

è¿™æ ·çš„è®¾è®¡æ—¢ä¿è¯äº†ä»£ç çš„å¯ç»´æŠ¤æ€§ï¼Œåˆæä¾›äº†è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚

